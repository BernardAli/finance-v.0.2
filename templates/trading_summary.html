{% extends 'base.html' %}
{% load static %}
{% load static %}
{% load mathfilters %}
{% load humanize %}

{% block title %} {{share_price_latest.date|date:"D d M, Y"}} Performance {% endblock %}

{% block content %}

<!-- Begin Page Content -->
<div class="container-fluid">
    <!-- Page Heading -->
    <div class="d-sm-flex align-items-center justify-content-between mb-4">
        <h1 class="h3 mb-0 text-gray-800">Trading Results</h1>
        <a href="#" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm"><i
                class="fas fa-download fa-sm text-white-50"></i> Market Report</a>
    </div>

    <div class="summary-heading  text text-center">
        <p>Date: {{share_price_latest.date|date:"D d M, Y"}}</p>
    </div>

    <div class="summary-table">
        <h4>GSE-CI Summary</h4>
        <table class="table table-striped table-bordered table-hover">
            <thead>
                <tr>
                    <th>Prev. Close</th>
                    <td>{{gse_ci_previous_close.value|intcomma}}</td>
                    <th>Open</th>
                    <td>{{gse_ci_open.value|intcomma}}</td>
                </tr>

                <tr>
                    <th>Volume</th>
                    <td>{{total_volume.volume__sum|intcomma}}</td>
                    <th>Total Traded Value GH(¢)</th>
                    <td>150,602</td>
                </tr>

                <tr>
                    <th>A month ago</th>
                    <td>{{gse_ci_one_month.value|intcomma}}</td>
                    <th>YTD (%)</th>
                    <td class="value">{{gse_ci_open.value|sub:gse_ci_year_start.value|div:gse_ci_year_start.value|mul:100|floatformat:2|intcomma}}</td>
                </tr>

                <tr>
                    <th>Market Cap GH(¢) mil</th>
                    <td id="mkt-cap"></td>
                    <th> Avg Vol (3months)</th>
                    <td>{{three_months_volume.volume__sum|div:three_months_days|floatformat:0|intcomma}}</td>
                </tr>
            </thead>
        </table>
    </div>
    <br />
    <div class="performance_summary">
        <ul class="nav nav-pills justify-content-center" id="pills-tab" role="tablist">
          <li class="nav-item">
            <a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-results" role="tab" aria-controls="pills-home" aria-selected="true">Day Results</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="pills-profile-tab" data-toggle="pill" href="#pills-performance" role="tab" aria-controls="pills-profile" aria-selected="false">Performance</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="pills-contact-tab" data-toggle="pill" href="#pills-summary" role="tab" aria-controls="pills-contact" aria-selected="false">Financial Summary</a>
          </li>
        </ul>
        <div class="tab-content" id="pills-tabContent">
          <div class="tab-pane fade show active" id="pills-results" role="tabpanel" aria-labelledby="pills-home-tab">
              <h6>{{share_price_latest.date|date:"D d M, Y"}}</h6>
              <table class="table table-striped table-bordered table-hover">
                    <thead>
                        <tr>
                            <th>Company Name</th>
                            <th>Symbol</th>
                            <th>Closing Share Price GH(¢)</th>
                            <th> Volume</th>
                            <th>Traded Value GH(¢)</th>
                            <th>Change</th>
                            <th>Change %</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for company in sp %}
                        <tr>
                            <td><a href="{{ company.company.get_absolute_url }}">{{ company.company.name }}</a></td>
                            <td>{{company.company}}</td>
                            <td>{{company.price}}</td>
                            <td>{{company.volume}}</td>
                            <td>{{company.volume|intcomma}}</td>
                            <td class="value">{{company.diff}}</td>
                            <td class="value">{{company.price|sub:company.prev_val|div:company.prev_val|mul:100|floatformat:2}}</td>
                        </tr>
                    {% endfor %}
                    </tbody>
              </table>
          </div>
          <div class="tab-pane fade" id="pills-performance" role="tabpanel" aria-labelledby="pills-profile-tab">
              <h4>Performance</h4>
              <table class="table table-striped table-bordered table-hover">
                    <thead>
                        <tr>
                            <th>Company Name</th>
                            <th>Symbol</th>
                            <th>Closing Share Price GH(¢)</th>
                            <th>Daily (%)</th>
                            <th>1 Month (%)</th>
                            <th>TYD (%)</th>
                            <th>1 Year (%)</th>
                            <th>3 Years (%)</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for company in sp %}
                        <tr>
                            <td title="{{company.company.name}}"><a href="{{ company.company.get_absolute_url }}">{{company.company.name}}</a></td>
                            <td class="value">{{company.diff|div:company.prev_val|mul:100|floatformat:2}}</td>
                            <td class="value">{{company.price|sub:company.prev_wk_val|div:company.prev_wk_val|mul:100|floatformat:2}}</td>
                            <td class="value">{{company.price|sub:company.prev_mothn_val|div:company.prev_mothn_val|mul:100|floatformat:2}}</td>
                            <td class="value">{{company.price|sub:company.ytd_val|div:company.ytd_val|mul:100|floatformat:2}}</td>
                            <td class="value">{{company.price|sub:company.one_yr_val|div:company.one_yr_val|mul:100|floatformat:2}}</td>
                            <td class="value">{{company.price|sub:company.three_yr_val|div:company.three_yr_val|mul:100|floatformat:2}}</td>
                            <td class="value">{{company.price|sub:company.five_yr_val|div:company.five_yr_val|mul:100|floatformat:2}}</td>
                        </tr>
                    {% endfor %}
                    </tbody>
              </table>
          </div>
          <div class="tab-pane fade" id="pills-summary" role="tabpanel" aria-labelledby="pills-contact-tab">
              <h4>Performance</h4>
              <table class="table table-striped table-bordered table-hover">
                    <thead>
                        <tr>
                            <th>Company Name</th>
                            <th>Symbol</th>
                            <th>Issued Shares (mil)</th>
                            <th>Market Cap. GH(¢) mil</th>
                            <th>Period Ends</th>
                            <th>Div Prev. Year</th>
                            <th>Div Yield(%)</th>
                            <th>EPS GH(¢)</th>
                            <th>P/E Ratio</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for company in data %}
                        <tr>
                            <td><a href="{{ company.get_absolute_url }}">{{ company.name }}</a></td>
                            <td>{{company.share_price.first.company}}</td>
                            <td>{{company.share_details.first.issued_shares|div:1000000|floatformat:2|intcomma}}</td>
                            <td class="mkt-cap-values">{{company.share_price.first.price|mul:company.share_details.first.issued_shares|div:1000000|floatformat:2}}</td>
                            <td>{{company.share_details.first.financial_period_ends}}</td>
                            <td>{% if company.dividend.first %}{{company.dividend.first.final_dividend|floatformat:2}} {% else %} 0.00 {% endif %}</td>
                            <td>{% if company.dividend.first %}{{company.dividend.first.final_dividend|div:company.share_price.first.price|mul:100|floatformat:2}} {% else %} 0.00 {% endif %}</td>
                            <td class="value">{% if company.statement.first %}{{company.statement.first.net_profit_loss|div:company.share_details.first.issued_shares|floatformat:2}}{% else %} 0.00 {% endif %}</td>
                            <td class="value">{% if company.statement.first %}{{company.share_price.first.price|mul:company.share_details.first.issued_shares|div:company.statement.first.net_profit_loss|floatformat:2}}{% else %} 0.00 {% endif %}</td>
                        </tr>
                    {% endfor %}
                    </tbody>
              </table>
          </div>
        </div>
    </div>

</div>
<!-- /.container-fluid -->

    <script>

    </script>

{% endblock %}

{% block script %}
<!-- Page level plugins -->
    <script src="{% static 'vendor/datatables/jquery.dataTables.min.js' %}"></script>
    <script src="{% static 'vendor/datatables/dataTables.bootstrap4.min.js' %}"></script>

    <!-- Page level custom scripts -->
    <script src="{% static 'js/demo/datatables-demo.js' %}"></script>
{% endblock %}