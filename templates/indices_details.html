{% extends 'base.html' %}
{% load mathfilters %}
{% load humanize %}
{% load static %}

{% block title %} {{ indices.symbol }}  {% endblock %}

{% block content %}

<!-- Begin Page Content -->
                <div class="container-fluid">

                    <!-- Page Heading -->
                    <div class="d-sm-flex align-items-center justify-content-between mb-4">
                        <h1 class="h3 mb-0 text-gray-800">{{ indices.name }} ({{ indices.symbol }})</h1>
                        <a href="#" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm"><i
                                class="fas fa-download fa-sm text-white-50"></i> Latest Report</a>
                    </div>

                   <div class="row">

                        <!-- Earnings (Monthly) Card Example -->
                        <div class="col-xl-12 col-md-12 mb-6">
                            <div class="card border-left-primary shadow h-100 py-2">
                                <div class="card-body">
                                    <div class="row no-gutters align-items-center">
                                        <div class="col mr-2">
                                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">{{ indices.name }}</div>
                                            <div class="h5 mb-0 font-weight-bold text-gray-800">
                                                {{ indices.symbol }}
                                            </div>
                                            <div class="h6 mb-0 font-weight-light text-gray-800">
                                                <strong> {{ point.value }}</strong>
                                                 <small class="value">{{ci.value|sub:ci_previous.value}}</small> (<small class="value">{{ci.value|sub:ci_previous.value|div:ci_previous.value|mul:100|floatformat:2}}%</small>)
                                            </div>
                                        </div>
                                        <div class="col-auto">
                                            <img src="{{ indices.country.flag.url }}" alt="" height="100">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <br>

                    <div class="row">

                        <div class="col-lg-8">

                            <!-- Default Card Example -->
                            <div class="card mb-4">
                                <div class="card-header py-3">
                                    <h6 class="m-0 font-weight-bold text-primary">{{ indices.symbol }} Summary</h6>
                                </div>
                                <div class="card-body text text-center">
                                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                                      <li class="nav-item">
                                        <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Overview</a>
                                      </li>
                                      <li class="nav-item">
                                        <a class="nav-link" id="contact-tab" data-toggle="tab" href="#contact" role="tab" aria-controls="contact" aria-selected="false">Chart</a>
                                      </li>
                                        <li class="nav-item">
                                        <a class="nav-link" id="technical-tab" data-toggle="tab" href="#technical" role="tab" aria-controls="contact" aria-selected="false">Technical</a>
                                      </li>
                                        </li>
                                        <li class="nav-item">
                                        <a class="nav-link" id="analysis-tab" data-toggle="tab" href="#analysis" role="tab" aria-controls="contact" aria-selected="false">Analysis</a>
                                      </li>
                                    </ul>
                                    <div class="tab-content" id="myTabContent">
                                      <div class="tab-pane fade show active mt-4" id="home" role="tabpanel" aria-labelledby="home-tab">
                                        <p>{{ indices.details }}</p>
                                      </div>
                                      <div class="tab-pane fade mt-4" id="contact" role="tabpanel" aria-labelledby="contact-tab">
                                            <div class="tab-pane fade show active" id="v-chart" role="tabpanel" aria-labelledby="v-chart-tab">
                                                        <button id="one_month" type="button">1M</button>
                                                        <button id="six_months" type="button">6M</button>
                                                        <button id="one_year" type="button">1Y</button>
                                                        <button id="three_year" type="button">3Y</button>
                                                        <button id="five_year" type="button">5Y</button>
                                                        <button id="ytd" type="button">YTD</button>
                                                        <button id="all" type="button">ALL</button>
                                                        <div id="ci_chart"></div>


                                                      <script>
                                                        const latest_trading_day = '{{share_price_latest.date}}';


                                                        const one_month = '{{one_month}}';


                                                        const six_month = '{{six_month}}';


                                                        const one_year = '{{one_year}}';

                                                        const three_year = '{{three_year}}';

                                                        const five_year = '{{five_year}}';

                                                        const share_price_first = '{{share_price_first}}';

                                                        const ci_dates = [{% for price in indices_val %} Date.parse('{{price.date}}'),{% endfor %}]

                                                        const ci_values = [{% for price in indices_val %} {{price.value}}, {% endfor %}]

                                                        var data = ci_dates.map(function(e, i){
                                                            return [e, ci_values[i]];
                                                        });

                                                        const series = {
                                                            "dataSeries": {
                                                              "dates": [{% for price in share_price %} '{{price.date|date:"D M, Y" }}', {% endfor %}],
                                                              "prices": [{% for price in share_price %} {{price.price}}, {% endfor %}]
                                                            }
                                                          }

                                                          var options = {
                                                          series: [{
                                                          name: "Share Price",
                                                          data: data
                                                        }],
                                                          chart: {
                                                          id: 'area-datetime',
                                                          type: 'area',
                                                          height: 350,
                                                          zoom: {
                                                            autoScaleYaxis: true
                                                          }
                                                        },
                                                        annotations: {
                                                          yaxis: [{
                                                            y: 30,
                                                            borderColor: '#999',
                                                            label: {
                                                              show: true,
                                                              style: {
                                                                color: "#fff",
                                                                background: '#00E396'
                                                              }
                                                            }
                                                          }],
                                                          xaxis: [{
                                                            x: new Date('{{share_price_first}}').getTime(),
                                                            borderColor: '#999',
                                                            yAxisIndex: 0,
                                                            label: {
                                                              show: true,
                                                              style: {
                                                                color: "#fff",
                                                                background: '#775DD0'
                                                              }
                                                            }
                                                          }]
                                                        },
                                                        dataLabels: {
                                                          enabled: false
                                                        },
                                                        markers: {
                                                          size: 0,
                                                          style: 'hollow',
                                                        },
                                                        xaxis: {
                                                          type: 'datetime',
                                                          min: new Date('{{share_price_first}}').getTime(),
                                                          tickAmount: 6,
                                                        },
                                                        tooltip: {
                                                          x: {
                                                            format: 'dd MMM yyyy',
                                                          }
                                                        },
                                                        fill: {
                                                          type: 'gradient',
                                                          gradient: {
                                                            shadeIntensity: 1,
                                                            opacityFrom: 0.7,
                                                            opacityTo: 0.9,
                                                            stops: [0, 100]
                                                          }
                                                        },
                                                        };

                                                        var chart = new ApexCharts(document.querySelector("#ci_chart"), options);
                                                        chart.render();

                                                        var resetCssClasses = function(activeEl) {
                                                            var els = document.querySelectorAll('button')
                                                            Array.prototype.forEach.call(els, function(el) {
                                                              el.classList.remove('active')
                                                            })

                                                            activeEl.target.classList.add('active')
                                                          }

                                                          document.querySelector('#one_month').addEventListener('click', function(e) {
                                                              resetCssClasses(e)

                                                              chart.zoomX(
                                                                new Date(one_month).getTime(),
                                                                new Date(latest_trading_day).getTime()
                                                              )
                                                            })

                                                          document.querySelector('#six_months').addEventListener('click', function(e) {
                                                              resetCssClasses(e)

                                                              chart.zoomX(
                                                                new Date(six_month).getTime(),
                                                                new Date(latest_trading_day).getTime()
                                                              )
                                                            })

                                                          document.querySelector('#one_year').addEventListener('click', function(e) {
                                                              resetCssClasses(e)
                                                              chart.zoomX(
                                                                new Date(one_year).getTime(),
                                                                new Date(latest_trading_day).getTime()
                                                              )
                                                            })

                                                            document.querySelector('#three_year').addEventListener('click', function(e) {
                                                              resetCssClasses(e)
                                                              chart.zoomX(
                                                                new Date(three_year).getTime(),
                                                                new Date(latest_trading_day).getTime()
                                                              )
                                                            })

                                                            document.querySelector('#five_year').addEventListener('click', function(e) {
                                                              resetCssClasses(e)
                                                              chart.zoomX(
                                                                new Date(five_year).getTime(),
                                                                new Date(latest_trading_day).getTime()
                                                              )
                                                            })

                                                          document.querySelector('#ytd').addEventListener('click', function(e) {
                                                            resetCssClasses(e)

                                                            chart.zoomX(
                                                              new Date('2023-01-01').getTime(),
                                                              new Date(latest_trading_day).getTime()
                                                            )
                                                          })

                                                          document.querySelector('#all').addEventListener('click', function(e) {
                                                            resetCssClasses(e)

                                                            chart.zoomX(
                                                              new Date(share_price_first).getTime(),
                                                              new Date().getTime(),
                                                            )
                                                          });
                                                      </script>
                                                        <!-- End Area Chart -->
                                                  </div>
                                      </div>
                                        <div class="tab-pane fade mt-4" id="technical" role="tabpanel" aria-labelledby="technical-tab">
                                            <div class="row">
                                              <div class="col-3">
                                                <div class="nav flex-column nav-pills" id="v-technical" role="tablist" aria-orientation="vertical">
                                                  <button class="nav-link active" id="v-ma-tab" data-toggle="pill" data-target="#v-ma" type="button" role="tab" aria-controls="v-ma" aria-selected="true">Moving Averages (Days)</button>
                                                    <br>
                                                  <button class="nav-link" id="v-tech-tab" data-toggle="pill" data-target="#v-tech" type="button" role="tab" aria-controls="v-tech" aria-selected="false">Technical Indicators (Days)</button>
                                                </div>
                                              </div>
                                              <div class="col-9">
                                                <div class="tab-content" id="v-technicalContent">
                                                  <div class="tab-pane fade show active" id="v-ma" role="tabpanel" aria-labelledby="v-ma-tab">
                                                      <table class="table table-striped table-bordered">
                                                        <thead>
                                                            <tr>
                                                                <th>Period (Days)</th>
                                                                <th>Simple</th>
                                                                <th>Action</th>
                                                            </tr>
                                                        </thead>
                                                          <tbody>
                                                            <tr>
                                                                <th>5</th>
                                                                <td>{{ma5.price__avg|floatformat:2}}</td>
                                                                <td></td>
                                                            </tr>
                                                          <tr>
                                                                <th>10</th>
                                                                <td>{{ma5.price__avg|floatformat:2}}</td>
                                                                <td></td>
                                                            </tr>
                                                          <tr>
                                                                <th>20</th>
                                                                <td>{{ma5.price__avg|floatformat:2}}</td>
                                                                <td></td>
                                                            </tr>
                                                          <tr>
                                                                <th>50</th>
                                                                <td>{{ma50.price__avg|floatformat:2}}</td>
                                                                <td></td>
                                                            </tr>
                                                          <tr>
                                                                <th>100</th>
                                                                <td>{{ma100.price__avg|floatformat:2}}</td>
                                                                <td></td>
                                                            </tr>
                                                        </tbody>
                                                      </table>
                                                  </div>
                                                  <div class="tab-pane fade" id="v-tech" role="tabpanel" aria-labelledby="v-tech-tab">
                                                      <table class="table table-striped table-bordered">
                                                        <thead>
                                                            <tr>
                                                                <th>Name</th>
                                                                <th>Value</th>
                                                                <th>Action</th>
                                                            </tr>
                                                        </thead>
                                                          <tbody>
                                                            <tr>
                                                                <th>RSI(14)</th>
                                                                <td></td>
                                                                <td></td>
                                                            </tr>
                                                          <tr>
                                                                <th>MACD(12,26)</th>
                                                                <td></td>
                                                                <td></td>
                                                            </tr>
                                                          <tr>
                                                                <th>ATR(14)</th>
                                                                <td></td>
                                                                <td></td>
                                                            </tr>
                                                          <tr>
                                                                <th>CCI(14)</th>
                                                                <td></td>
                                                                <td></td>
                                                            </tr>
                                                          <tr>
                                                                <th>Highs/Lows(14)</th>
                                                                <td>{{high_14.price__max|floatformat:2}}/{{low_14.price__min|floatformat:2}}</td>
                                                                <td></td>
                                                            </tr>
                                                        </tbody>
                                                      </table>
                                                  </div>
                                                </div>
                                              </div>
                                            </div>
                                      </div>
                                        <div class="tab-pane fade mt-4" id="analysis" role="tabpanel" aria-labelledby="analysis-tab">
                                            <div class="card-body">
                                                <div class="row pb-2">
                                                    {% for opinion in analysis %}
                                                    <div class="col-lg-6 mb-12">
                                                        <div class="card shadow">
                                                            <div class="card-body">
                                                                <div class="row no-gutters align-items-center">
                                                                    <div class="col mr-2">
                                                                        <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                                                                            {{ opinion.author}} </div>
                                                                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{ new.title}}</div>
                                                                        <p>{{ opinion.opinion|truncatewords:20|linebreaks }}</p>
                                                                        <a href="{{ opinion.get_absolute_url }}" class="btn btn-primary">Read More</a>
                                                                        <p><i class="fas fa-calendar-day"></i> {{ opinion.date|naturaltime }} </p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    {% empty %}
                                                        <p>No Analysis Available</p>
                                                    {% endfor %}
                                                </div>
                                            </div>
                                      </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Default Card Example -->
                            <!-- Default Card Example -->
                            <div class="card mb-4">
                                <div class="card-header py-3">
                                    <h6 class="m-0 font-weight-bold text-primary">Pro <i class='bx bxs-lock'></i></h6>

                                </div>
                                <div class="card-body text text-center">
                                    <ul class="nav nav-tabs" id="myPro" role="tablist">
                                      <li class="nav-item">
                                        <a class="nav-link active" id="fairvalue-tab" data-toggle="tab" href="#fairvalue" role="tab" aria-controls="contact" aria-selected="false">Fair value</a>
                                      </li>
                                        <li class="nav-item">
                                        <a class="nav-link" id="score-tab" data-toggle="tab" href="#score" role="tab" aria-controls="score" aria-selected="false">Index Score</a>
                                      </li>
                                        <li class="nav-item">
                                        <a class="nav-link" id="health-tab" data-toggle="tab" href="#health" role="tab" aria-controls="health" aria-selected="false">Index Health</a>
                                      </li>
                                        <li class="nav-item">
                                        <a class="nav-link" id="Advisory-tab" data-toggle="tab" href="#Advisory" role="tab" aria-controls="Advisory" aria-selected="false">Index Advisory</a>
                                      </li>
                                    </ul>
                                    <div class="tab-content" id="myProContent">
                                      <div class="tab-pane fade show active pt-3" id="fairvalue" role="tabpanel" aria-labelledby="fairvalue-tab">
                                        <p>Index Fair Value Here</p>
                                      </div>
                                      <div class="tab-pane fade show pt-3" id="score" role="tabpanel" aria-labelledby="score-tab">
                                        <p>Index Score Here</p>
                                      </div>
                                        <div class="tab-pane fade show pt-3" id="health" role="tabpanel" aria-labelledby="health-tab">
                                        <p>Index Health Here</p>
                                      </div>
                                        <div class="tab-pane fade show pt-3" id="Advisory" role="tabpanel" aria-labelledby="Advisory-tab">
                                        <p>Index Advisory Here</p>
                                      </div>

                                    </div>
                                </div>
                            </div>

                            <!-- Basic Card Example -->
                            {% include 'companies_performance.html' %}

                        </div>

                        <div class="col-lg-4">

                            <!-- Dropdown Card Example -->
                            <div class="card shadow mb-4">
                                <!-- Card Header - Dropdown -->
                                <div
                                    class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary">Basic Info.</h6>
                                    <div class="dropdown no-arrow">
                                        <a class="dropdown-toggle" href="#" role="button" id="basicInfo"
                                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                                        </a>
                                        <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in"
                                            aria-labelledby="basicInfo">
                                            <div class="dropdown-header">Dropdown Header:</div>
                                            <a class="dropdown-item" href="#">Action</a>
                                            <a class="dropdown-item" href="#">Another action</a>
                                            <div class="dropdown-divider"></div>
                                            <a class="dropdown-item" href="#">Something else here</a>
                                        </div>
                                    </div>
                                </div>
                                <!-- Card Body -->
                                <div class="card-body">
                                    <p><strong>Country:</strong><a href="{% url 'country' indices.country.slug %}"> {{ indices.country.name }}</a></p>
                                    <p><strong>Components:</strong> {{ index_components }}</p>
                                    <p><strong>Main Exchange:</strong> {{ indices.main_exchange }}</p>
                                    <p><strong>Time Zone:</strong> {{ indices.country.time_zone }}</p>
                                </div>
                            </div>

                            <div class="card shadow mb-4">
                                <!-- Card Header - Dropdown -->
                                <div
                                    class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary">Value Summary</h6>
                                </div>
                                <!-- Card Body -->
                                <div class="card-body">
                                    <p><strong>Prev. Close:</strong>  {{ point.value }}</p>
                                        <p><strong>Open:</strong>  {{ point.value }}</p>
                                        <p><strong>Days Range:</strong> {{ point.value }} -  {{ point.value }}</p>
                                        <p><strong>52 wk Range Range:</strong> {{ low_52.value__min }} -  {{ high_52.value__max }}</p>
                                        <p><strong>Total Mkt Cap:</strong>  <span id="mkt-cap"></span></p>
                                </div>
                            </div>

                            <div class="card shadow mb-4">
                                <!-- Card Header - Dropdown -->
                                <div
                                    class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary">Stock Price Performance</h6>
                                </div>
                                <!-- Card Body -->
                                <div class="card-body">
                                    <table class="table table-bordered table-striped text text-center table-hover">
                                        <thead>
                                            <tr>
                                                <th>Period</th>
                                                <th>Performance</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>1 Month</td>
                                                <td id="month-1">{% for value in index_values %}
                                                        {{value.value|sub:value.prev_mothn_val }} (<span class="value">{{value.value|sub:value.prev_mothn_val|div:value.prev_mothn_val|mul:100|floatformat:2 }}%</span>)
                                                    {% endfor %}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>YTD</td>
                                                <td>{% for value in index_values %}
                                                        {{value.value|sub:value.ytd_val }} (<span class="value">{{value.value|sub:value.ytd_val|div:value.ytd_val|mul:100|floatformat:2 }}%</span>)
                                                    {% endfor %}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>1 Year</td>
                                                <td>{% for value in index_values %}
                                                        {{value.value|sub:value.one_yr_val }} (<span class="value">{{value.value|sub:value.one_yr_val|div:value.one_yr_val|mul:100|floatformat:2 }}%</span>)
                                                    {% endfor %}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>3 Years</td>
                                                <td>{% for value in index_values %}
                                                        {{value.value|sub:value.three_yr_val }} (<span class="value">{{value.value|sub:value.three_yr_val|div:value.three_yr_val|mul:100|floatformat:2 }}%</span>)
                                                    {% endfor %}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>5 Years</td>
                                                <td>{% for value in index_values %}
                                                        {{value.value|sub:value.five_yr_val }} (<span class="value">{{value.value|sub:value.five_yr_val|div:value.five_yr_val|mul:100|floatformat:2 }}%</span>)
                                                    {% endfor %}
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>


                            <!-- Dropdown Card Example -->
                            <div class="card shadow mb-4">
                                <!-- Card Header - Dropdown -->
                                <div
                                    class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary">Video Here</h6>
                                    <div class="dropdown no-arrow">
                                        <a class="dropdown-toggle" href="#" role="button" id="Summary"
                                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                                        </a>
                                        <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in"
                                            aria-labelledby="Summary">
                                            <div class="dropdown-header">Dropdown Header:</div>
                                            <a class="dropdown-item" href="#">Action</a>
                                            <a class="dropdown-item" href="#">Another action</a>
                                            <div class="dropdown-divider"></div>
                                            <a class="dropdown-item" href="#">Something else here</a>
                                        </div>
                                    </div>
                                </div>
                                <!-- Card Body -->
                                <div class="card-body">
                                    Video Here
                                </div>
                            </div>

                            <!-- Dropdown Card Example -->
                            <div class="card shadow mb-4">
                                <!-- Card Header - Dropdown -->
                                <div
                                    class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary">Press Releases</h6>
                                    <div class="dropdown no-arrow">
                                        <a class="dropdown-toggle" href="#" role="button" id="dropdownMenuLink"
                                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                                        </a>
                                        <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in"
                                            aria-labelledby="dropdownMenuLink">
                                            <div class="dropdown-header">Dropdown Header:</div>
                                            <a class="dropdown-item" href="#">Action</a>
                                            <a class="dropdown-item" href="#">Another action</a>
                                            <div class="dropdown-divider"></div>
                                            <a class="dropdown-item" href="#">Something else here</a>
                                        </div>
                                    </div>
                                </div>
                                <!-- Card Body -->
                                <div class="card-body">
                                    <div class="text">
                                        {% for press in release %}
                                            <p><img src="{% static 'img/pdf.png' %}" alt="" height="30"><a href="{{ press.file.url }}" target="_blank"> {{ press.title }} </a><i class="fas fa-download"></i></p>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>

                            <!-- Collapsable Card Example -->
                            <div class="card shadow mb-4">
                                <!-- Card Header - Accordion -->
                                <a href="#collapse1" class="d-block card-header py-3" data-toggle="collapse"
                                    role="button" aria-expanded="true" aria-controls="collapseCardExample">
                                    <h6 class="m-0 font-weight-bold text-primary">{{ indices.symbol }} Price History</h6>
                                </a>
                                <!-- Card Content - Collapse -->
                                <div class="collapse show" id="collapse1">
<!--                                    <div class="card-body">-->
<!--                                        <table>-->
<!--                                            {% for price in share_price %}-->
<!--                                                <li>{{ price.date }} - {{ price.price }}</li>-->
<!--                                            {% endfor %}-->
<!--                                        </table>-->
<!--                                    </div>-->

                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table table-bordered" id="dataTable" width="70%" cellspacing="0">
                                            <thead>
                                                <tr>
                                                    <th>Date</th>
                                                    <th>Close</th>
                                                </tr>
                                            </thead>
<!--                                            <tfoot>-->
<!--                                                <tr>-->
<!--                                                    <th>Date</th>-->
<!--                                                    <th>Close</th>-->
<!--                                                    <th>Volume</th>-->
<!--                                                </tr>-->
<!--                                            </tfoot>-->
                                            <tbody>
                                            {% for point in points %}
                                                <tr>
                                                    <td>{{ point.date|date:"Y/m/d" }}</td>
                                                    <td>{{ point.value }}</td>
                                                </tr>
                                            {% endfor %}
                                            </tbody>
                                        </table>
                                        </div>

                                    </div>
                                </div>
                            </div>

                            <div class="card shadow mb-4">
                                <!-- Card Header - Dropdown -->
                                <div
                                    class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary">Related Indices</h6>
                                </div>
                                <!-- Card Body -->
                                <div class="card-body">
                                    {% for similar in similar_index %}
                                        <p><a href="{% url 'index_detail' similar.id %}">{{similar.name}} ({{similar}})</a></p>
                                    {% empty %}
                                        <p><strong>No similar index available</strong></p>
                                    {% endfor %}
                                </div>
                            </div>

                        </div>

                    </div>

                </div>
                <!-- /.container-fluid -->

    <script>
                let mkt_cap = document.querySelector('#mkt-cap');
                mkt_cap.innerText = "Yes";

                let cap_values = document.querySelectorAll('.mkt-cap-values');
                let total_cap = 0
                for (const element of cap_values) {
                    console.log(element.innerText);
                    console.log(typeof parseFloat(element.innerText));
                    total_cap += parseFloat(element.innerText)
        //            console.log(total_cap);
                }
                console.log(Math.round(total_cap));
                mkt_cap.innerText = parseFloat(total_cap).toFixed(2);
    </script>

{% endblock %}
{% block script %}
<!-- Page level plugins -->
    <script src="{% static 'vendor/datatables/jquery.dataTables.min.js' %}"></script>
    <script src="{% static 'vendor/datatables/dataTables.bootstrap4.min.js' %}"></script>

    <!-- Page level custom scripts -->
    <script src="{% static 'js/demo/datatables-demo.js' %}"></script>
{% endblock %}